@model Figlut.Spread.Web.Site.Models.UserModel

<div id="dlgCreateUser">
    <img src="~/Images/Icons/red-document-plus-icon32.png" style="float:right; margin-right:1%; margin-left:1%" />
    <div class="centerForm">
        <form id="CreateUserForm">
            @Html.ValidationSummary(true, "Failed to create.")
            <fieldset>
                <legend>Confirmation Form</legend>
                @Html.HiddenFor(m => m.UserId)
                @Html.HiddenFor(m => m.OrganizationId)
                @Html.HiddenFor(m => m.LastLoginDate)
                @Html.HiddenFor(m => m.LastActivityDate)
                @Html.HiddenFor(m => m.DateCreated)
                <div class="field-label">
                    @Html.Raw("User Name *")
                </div>
                <div class="editor-field">
                    @Html.EditorFor(m => m.UserName)
                    @Html.ValidationMessageFor(m => m.UserName)
                </div>
                <div class="field-label">
                    @Html.Raw("Email Address *")
                </div>
                <div class="editor-field-dialog">
                    @Html.EditorFor(m => m.UserEmailAddress)
                    @Html.ValidationMessageFor(m => m.UserEmailAddress)
                </div>
                <div class="field-label">
                    @Html.Raw("Password *")
                </div>
                <div class="editor-field">
                    @Html.PasswordFor(m => m.UserPassword)
                    @Html.ValidationMessageFor(m => m.UserPassword)
                </div>
                <div class="field-label">
                    @Html.Raw("Confirm Password *")
                </div>
                <div class="editor-field">
                    @Html.PasswordFor(m => m.UserPasswordConfirm)
                    @Html.ValidationMessageFor(m => m.UserPasswordConfirm)
                </div>
                @if (ViewBag.UserRolesList != null)
                {
                    <div class="field-label">
                        @Html.Raw("Role *")
                    </div>
                    <div class="editor-field">
                        @Html.DropDownList("Role", ViewBag.UserRolesList as List<SelectListItem>, new { @class = "drop-down-field" })
                    </div>
                }
                <br />
                <div id="CreateUserErrorField" style="color:#8A0808"></div>
            </fieldset>
        </form>
    </div>
</div>

<script type="text/javascript">
    $(function () {
        var dialogName = '#dlgCreateUser';
        createDialog(dialogName, 'Create User', onConfirmOK, onConfirmOpen, onConfirmCancel, 450, 450);
    });

    function onConfirmOK() {
        var dialogName = '#dlgCreateUser';
        var postBackUrl = '@Url.Action("CreateDialog", "User")';
        $.ajax({
            url: postBackUrl,
            type: 'POST',
            data: $("#CreateUserForm").serialize(),
            success: function (data) {
                if (data.Success) {
                    $(dialogName).dialog("close");
                    //Submit the form which will refresh grid to show the change the enabled/disabled.
                    var form = $('#frmDetails');
                    form.submit()
                } else {
                    $("#CreateUserErrorField").html(data.ErrorMsg);
                }
            }
        })
    };

    function onConfirmOpen() {

    }

    function onConfirmCancel() {
        //$('#confirmation-message').val('');
        $("#CreateUserErrorField").html('');
    }
</script>